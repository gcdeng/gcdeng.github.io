(self.webpackChunkgcdeng_github_io=self.webpackChunkgcdeng_github_io||[]).push([[363],{3905:function(e,t,r){"use strict";r.d(t,{Zo:function(){return o},kt:function(){return f}});var n=r(7294);function a(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function i(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function c(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?i(Object(r),!0).forEach((function(t){a(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):i(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function p(e,t){if(null==e)return{};var r,n,a=function(e,t){if(null==e)return{};var r,n,a={},i=Object.keys(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)>=0||(a[r]=e[r]);return a}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}var l=n.createContext({}),s=function(e){var t=n.useContext(l),r=t;return e&&(r="function"==typeof e?e(t):c(c({},t),e)),r},o=function(e){var t=s(e.components);return n.createElement(l.Provider,{value:t},e.children)},u={inlineCode:"code",wrapper:function(e){var t=e.children;return n.createElement(n.Fragment,{},t)}},d=n.forwardRef((function(e,t){var r=e.components,a=e.mdxType,i=e.originalType,l=e.parentName,o=p(e,["components","mdxType","originalType","parentName"]),d=s(r),f=a,m=d["".concat(l,".").concat(f)]||d[f]||u[f]||i;return r?n.createElement(m,c(c({ref:t},o),{},{components:r})):n.createElement(m,c({ref:t},o))}));function f(e,t){var r=arguments,a=t&&t.mdxType;if("string"==typeof e||a){var i=r.length,c=new Array(i);c[0]=d;var p={};for(var l in t)hasOwnProperty.call(t,l)&&(p[l]=t[l]);p.originalType=e,p.mdxType="string"==typeof e?e:a,c[1]=p;for(var s=2;s<i;s++)c[s]=r[s];return n.createElement.apply(null,c)}return n.createElement.apply(null,r)}d.displayName="MDXCreateElement"},9975:function(e,t,r){"use strict";r.r(t),r.d(t,{frontMatter:function(){return p},contentTitle:function(){return l},metadata:function(){return s},toc:function(){return o},default:function(){return d}});var n=r(2122),a=r(9756),i=(r(7294),r(3905)),c=["components"],p={slug:"script-tag-async-defer-attributes",title:"[\u524d\u7aef\u512a\u5316\u7cfb\u5217] \u4f7f\u7528async, defer\u5c6c\u6027\u52a0\u901f\u7db2\u9801\u8f09\u5165\u6642\u9593",author:"Eric Deng",author_url:"/about",author_image_url:"/img/ericdeng.jpg",tags:["performance","frontend","web"],keywords:["performance","frontend","web"]},l=void 0,s={permalink:"/script-tag-async-defer-attributes",source:"@site/blog/2021-11-04-script-tag-async-defer-attributes.md",title:"[\u524d\u7aef\u512a\u5316\u7cfb\u5217] \u4f7f\u7528async, defer\u5c6c\u6027\u52a0\u901f\u7db2\u9801\u8f09\u5165\u6642\u9593",description:"\u700f\u89bd\u5668\u5728\u89e3\u6790 HTML \u6642\u5982\u679c\u9047\u5230...\u5c31\u6703\u66ab\u505c\u89e3\u6790\u76f4\u63a5\u958b\u59cb\u57f7\u884c\uff0c\u5982\u679c\u662f\u5916\u90e8\u8cc7\u6e90``\u6703\u7b49\u5f85\u4e0b\u8f09\u4e26\u57f7\u884c\u5b8c\u6210\u4e4b\u5f8c\u624d\u958b\u59cb\u7e7c\u7e8c\u89e3\u6790 HTML \u5efa\u7acb DOM\uff0c\u9019\u6a23\u7576\u9047\u5230\u5167\u5bb9\u5f88\u591a\u7684 script \u6642\u5c07\u6703\u5ef6\u9577\u9801\u9762\u6e32\u67d3\u7684\u6642\u9593\uff0c\u4e5f\u6703\u8b93\u4f7f\u7528\u8005\u66f4\u6162\u770b\u5230\u7db2\u9801\u5167\u5bb9\u5f71\u97ff\u4f7f\u7528\u9ad4\u9a57\u3002",date:"2021-11-04T00:00:00.000Z",formattedDate:"November 4, 2021",tags:[{label:"performance",permalink:"/tags/performance"},{label:"frontend",permalink:"/tags/frontend"},{label:"web",permalink:"/tags/web"}],readingTime:.99,truncated:!1,prevItem:{title:"Prerender.io\u5982\u4f55\u5e6b\u52a9CSR\u7684SEO - \u539f\u7406\u4ecb\u7d39\u8207\u4f7f\u7528\u6559\u5b78",permalink:"/solve-seo-problems-with-prerenderio"},nextItem:{title:"[\u8cc7\u5b89\u7cfb\u5217] \u9632\u79a6CSRF\u653b\u64ca\u7684\u4e94\u7a2e\u65b9\u6cd5",permalink:"/five-ways-to-defend-against-CSRF-attacks"}},o=[{value:"async, defer \u7684\u5171\u540c\u9ede",id:"async-defer-\u7684\u5171\u540c\u9ede",children:[]},{value:"defer",id:"defer",children:[]},{value:"async",id:"async",children:[]},{value:"Dynamic scripts",id:"dynamic-scripts",children:[]},{value:"\u5f88\u5c11\u6703\u76f4\u63a5\u64b0\u5beb HTML\uff0c\u5be6\u52d9\u4e0a\u6703\u600e\u9ebc\u505a\u5462\uff1f",id:"\u5f88\u5c11\u6703\u76f4\u63a5\u64b0\u5beb-html\uff0c\u5be6\u52d9\u4e0a\u6703\u600e\u9ebc\u505a\u5462\uff1f",children:[]},{value:"\u7e3d\u7d50",id:"\u7e3d\u7d50",children:[]},{value:"Reference",id:"reference",children:[]}],u={toc:o};function d(e){var t=e.components,p=(0,a.Z)(e,c);return(0,i.kt)("wrapper",(0,n.Z)({},u,p,{components:t,mdxType:"MDXLayout"}),(0,i.kt)("p",null,"\u700f\u89bd\u5668\u5728\u89e3\u6790 HTML \u6642\u5982\u679c\u9047\u5230",(0,i.kt)("inlineCode",{parentName:"p"},"<script>...<\/script>"),"\u5c31\u6703\u66ab\u505c\u89e3\u6790\u76f4\u63a5\u958b\u59cb\u57f7\u884c\uff0c\u5982\u679c\u662f\u5916\u90e8\u8cc7\u6e90",(0,i.kt)("inlineCode",{parentName:"p"},'<script src="..."><\/script>'),"\u6703\u7b49\u5f85\u4e0b\u8f09\u4e26\u57f7\u884c\u5b8c\u6210\u4e4b\u5f8c\u624d\u958b\u59cb\u7e7c\u7e8c\u89e3\u6790 HTML \u5efa\u7acb DOM\uff0c\u9019\u6a23\u7576\u9047\u5230\u5167\u5bb9\u5f88\u591a\u7684 script \u6642\u5c07\u6703\u5ef6\u9577\u9801\u9762\u6e32\u67d3\u7684\u6642\u9593\uff0c\u4e5f\u6703\u8b93\u4f7f\u7528\u8005\u66f4\u6162\u770b\u5230\u7db2\u9801\u5167\u5bb9\u5f71\u97ff\u4f7f\u7528\u9ad4\u9a57\u3002"),(0,i.kt)("p",null,(0,i.kt)("inlineCode",{parentName:"p"},"async"),", ",(0,i.kt)("inlineCode",{parentName:"p"},"defer")," \u6b63\u662f\u70ba\u4e86\u89e3\u6c7a\u4e0a\u8ff0\u554f\u984c\u800c\u751f\u7684\u5169\u500b script tag \u5c6c\u6027\uff0c\u9019\u7bc7\u6587\u7ae0\u6703\u4ecb\u7d39\u4ed6\u5011\u7684\u5171\u540c\u9ede\u8207\u76f8\u7570\u9ede\uff0c\u4ee5\u53ca\u5404\u81ea\u9069\u7528\u7684\u60c5\u5883\u3002"),(0,i.kt)("p",null,(0,i.kt)("img",{alt:"script-async-defer.png",src:r(9390).Z})),(0,i.kt)("p",null,"\u6642\u5e8f\u5716 (\u4f86\u6e90\uff1aSpeed up Google Maps(and everything else) with async & defer)"),(0,i.kt)("h2",{id:"async-defer-\u7684\u5171\u540c\u9ede"},"async, defer \u7684\u5171\u540c\u9ede"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"\u89e3\u6790 HTML \u6642\u8dd1\u5230\u5c31\u958b\u59cb\u80cc\u666f\u4e0b\u8f09 script\uff0c\u4e0b\u8f09\u6642\u4e0d\u963b\u64cb\u700f\u89bd\u5668\u89e3\u6790 HTML\u3001\u5efa\u7acb DOM\uff0c\u5982\u6b64\u4e00\u4f86\u9801\u9762\u6e32\u67d3\u5b8c\u6210\u4f7f\u7528\u8005\u5c31\u53ef\u4ee5\u5148\u770b\u5230\u7db2\u9801\u5167\u5bb9\u3002"),(0,i.kt)("li",{parentName:"ul"},"\u53ea\u5c0d\u5f9e\u5916\u90e8\u8f09\u5165\u7684 script \u6709\u6548\uff0c\u4e5f\u5c31\u662f\u6c92\u6709 src \u7684 inline script \u6c92\u6709\u4f5c\u7528\uff0c\u6703\u76f4\u63a5\u958b\u59cb\u57f7\u884c\u3002")),(0,i.kt)("h2",{id:"defer"},"defer"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"DOM \u5efa\u7acb\u5b8c\u6210\u4e4b\u5f8c\u624d\u958b\u59cb\u57f7\u884c script\u3002"),(0,i.kt)("li",{parentName:"ul"},"\u52a0\u4e86 defer \u7684 script \u4e4b\u9593\u6703\u7167\u8457\u5beb\u5728 HTML \u7684\u9806\u5e8f\u57f7\u884c\uff0c\u5c31\u7b97\u5148\u4e0b\u8f09\u597d\u4e86\u4e5f\u6703\u7b49\u524d\u9762\u7684\u57f7\u884c\u5b8c\u6210\u3002")),(0,i.kt)("p",null,"\u9069\u7528\u60c5\u5883\uff1a"),(0,i.kt)("p",null,"\u4f9d\u8cf4 DOM \u6216\u5176\u4ed6 script\uff0c\u4f8b\u5982\u6703\u9700\u8981\u4f7f\u7528 HTML element \u6216\u662f\u5176\u4ed6 script \u7684\u8cc7\u6599\uff0c\u7b26\u5408\u5927\u90e8\u5206\u7684\u4f7f\u7528\u60c5\u5883\uff0c\u901a\u5e38\u90fd\u53ef\u4ee5\u52a0\u4e0a\u9019\u500b\u5c6c\u6027\uff0c\u7136\u5f8c\u628a script tag \u653e\u5728",(0,i.kt)("inlineCode",{parentName:"p"},"<head>"),"\u88e1\u8b93\u4ed6\u76e1\u65e9\u958b\u59cb\u80cc\u666f\u4e0b\u8f09\uff0c\u53ea\u9700\u8981\u6ce8\u610f\u5beb\u5728 HTML \u4e0a\u7684\u57f7\u884c\u5148\u5f8c\u9806\u5e8f\u3002"),(0,i.kt)("h2",{id:"async"},"async"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"\u4e0d\u7ba1 DOM \u597d\u4e86\u6c92\uff0cscript \u4e0b\u8f09\u597d\u5c31\u57f7\u884c\uff0c\u958b\u59cb\u57f7\u884c\u4e4b\u5f8c\u4f9d\u7136\u6703\u66ab\u505c\u89e3\u6790 HTML\u3002"),(0,i.kt)("li",{parentName:"ul"},"\u52a0\u4e86 async \u7684 script \u4e4b\u9593\u4e0d\u4fdd\u8b49\u57f7\u884c\u9806\u5e8f\uff0c\u4e5f\u4e0d\u6703\u7b49\u5f85\u5176\u4ed6 script\uff0c\u5148\u4e0b\u8f09\u597d\u5148\u57f7\u884c\u3002")),(0,i.kt)("p",null,"\u9069\u7528\u60c5\u5883\uff1a"),(0,i.kt)("p",null,"\u6c92\u6709\u76f8\u4f9d\u6027\u7684 script\uff0c\u4e0d\u4f9d\u8cf4 DOM \u6216\u5176\u4ed6 script\uff0c\u8ab0\u5148\u57f7\u884c\u90fd\u6c92\u95dc\u4fc2\uff0c\u9069\u7528\u65bc\u7368\u7acb\u7684\u7b2c\u4e09\u65b9 script \u50cf GA, GTM, ads..."),(0,i.kt)("h2",{id:"dynamic-scripts"},"Dynamic scripts"),(0,i.kt)("p",null,"\u6709\u6642\u5019\u53ef\u80fd\u6703\u5beb js \u52d5\u614b\u5efa\u7acb script tag \u7136\u5f8c\u63d2\u5165 HTML\uff0c\u9019\u6a23\u88ab\u8f09\u5165\u7684 script \u7a31\u70ba Dynamic scripts\uff0c\u50cf\u662f\u9019\u6a23 \ud83d\udc47"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-jsx"},"let script = document.createElement('script');\nscript.src = '/article/script-async-defer/long.js';\ndocument.body.append(script); // (*)\n")),(0,i.kt)("p",null,"\u4ee5\u9019\u7a2e\u65b9\u5f0f\u63d2\u5165\u7684 script \u9810\u8a2d",(0,i.kt)("inlineCode",{parentName:"p"},"async"),"\u6548\u679c\uff0c\u63d2\u5165 document \u4e4b\u5f8c",(0,i.kt)("inlineCode",{parentName:"p"},"(*)"),"\u5c31\u958b\u59cb\u80cc\u666f\u4e0b\u8f09\u3002\u5982\u679c\u60f3\u8981\u6539\u6210",(0,i.kt)("inlineCode",{parentName:"p"},"defer"),"\u53ea\u8981\u8a2d\u5b9a",(0,i.kt)("inlineCode",{parentName:"p"},"script.async=false"),"\u5c31\u53ef\u4ee5\u4e86\uff0c\u80cc\u666f\u4e0b\u8f09\u5b8c\u6210\u5f8c\u6703\u7167\u8457\u63d2\u5165 document \u7684\u9806\u5e8f\u57f7\u884c script\u3002"),(0,i.kt)("h2",{id:"\u5f88\u5c11\u6703\u76f4\u63a5\u64b0\u5beb-html\uff0c\u5be6\u52d9\u4e0a\u6703\u600e\u9ebc\u505a\u5462\uff1f"},"\u5f88\u5c11\u6703\u76f4\u63a5\u64b0\u5beb HTML\uff0c\u5be6\u52d9\u4e0a\u6703\u600e\u9ebc\u505a\u5462\uff1f"),(0,i.kt)("p",null,"\u73fe\u5728\u901a\u5e38\u6703\u4f7f\u7528 webpack \u4f86\u6253\u5305 js\uff0c\u53ef\u4ee5\u642d\u914d",(0,i.kt)("a",{parentName:"p",href:"https://github.com/jantimon/html-webpack-plugin#writing-your-own-templates"},"html-webpack-plugin"),"\uff0c\u4ed6\u6703\u751f\u6210 HTML \u4e26\u5f15\u5165\u6253\u5305\u597d\u7684 script\uff0c\u53ef\u4ee5\u5728\u4f7f\u7528\u6642\u8a2d\u5b9a",(0,i.kt)("inlineCode",{parentName:"p"},"scriptLoading"),"\u53c3\u6578\u70ba",(0,i.kt)("inlineCode",{parentName:"p"},"defer"),"\u3002"),(0,i.kt)("p",null,"\u5269\u4e0b\u5176\u4ed6\u7b2c\u4e09\u65b9\u7684 script \u6703\u9700\u8981\u76f4\u63a5\u5beb\u5728 HTML \u4e2d\uff0c\u9019\u6642\u5c31\u53ef\u4ee5\u52a0\u4e0a",(0,i.kt)("inlineCode",{parentName:"p"},"acync"),"\u5c6c\u6027\u3002"),(0,i.kt)("h2",{id:"\u7e3d\u7d50"},"\u7e3d\u7d50"),(0,i.kt)("p",null,"\u9019\u5169\u500b\u5c6c\u6027\u8b93\u8f09\u5165\u9801\u9762\u6642\u53ef\u4ee5\u66f4\u65e9\u958b\u59cb\u4e0b\u8f09 script \u540c\u6642\u89e3\u6790 HTML\uff0c\u7b97\u662f\u4e00\u500b\u5c0f\u5c0f\u8209\u624b\u4e4b\u52de\u5c31\u53ef\u4ee5\u52a0\u901f\u7db2\u9801\u8f09\u5165\u6642\u9593\u7684\u65b9\u6cd5\u5594\u3002"),(0,i.kt)("p",null,"\u5982\u679c\u6709\u4efb\u4f55\u554f\u984c\u6216\u5efa\u8b70\u6b61\u8fce\u8207\u6211\u806f\u7d61\u8a0e\u8ad6\u3002"),(0,i.kt)("h2",{id:"reference"},"Reference"),(0,i.kt)("p",null,(0,i.kt)("a",{parentName:"p",href:"https://developer.mozilla.org/en-US/docs/Web/HTML/Element/script"},"The Script element - HTML: HyperText Markup Language | MDN")),(0,i.kt)("p",null,(0,i.kt)("a",{parentName:"p",href:"https://javascript.info/script-async-defer"},"Scripts: async, defer")),(0,i.kt)("p",null,(0,i.kt)("a",{parentName:"p",href:"https://flaviocopes.com/javascript-async-defer/"},"Efficiently load JavaScript with defer and async")),(0,i.kt)("p",null,(0,i.kt)("a",{parentName:"p",href:"https://medium.com/schaoss-blog/02-html-script-tag-%E5%8A%A0%E4%B8%8A-async-defer-%E7%9A%84%E5%8A%9F%E8%83%BD%E5%8F%8A%E5%B7%AE%E7%95%B0-8205fddbbafc"},"\u524d\u7aef\u4e09\u5341\uff5c 02. [HTML] script tag \u52a0\u4e0a async & defer \u7684\u529f\u80fd\u53ca\u5dee\u7570\uff1f")),(0,i.kt)("p",null,(0,i.kt)("a",{parentName:"p",href:"https://pjchender.dev/javascript/js-async-defer/"},"[JS] Async, defer attributes | PJCHENder \u672a\u6574\u7406\u7b46\u8a18")))}d.isMDXComponent=!0},9390:function(e,t,r){"use strict";t.Z=r.p+"assets/images/script-async-defer-e7896ef157e507e7a3c7af930a42d504.png"}}]);